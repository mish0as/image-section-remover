<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CutMask-Image Portion Remover.</title>
  <style>
    :root {
      --primary: #00ff9d;
      --secondary: #00b8ff;
      --tertiary: #ff00aa;
      --dark: #121212;
      --darker: #0a0a0a;
      --light: #f5f5f5;
      --overlay: rgba(0, 255, 157, 0.2);
      --glass: rgba(255, 255, 255, 0.05);
      --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      background: var(--dark);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(0, 255, 157, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(0, 184, 255, 0.1) 0%, transparent 50%);
    }
    
    .container {
      width: 100%;
      max-width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
    }
    
    header {
      text-align: center;
      margin-bottom: 1rem;
    }
    
    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 0.5rem;
      letter-spacing: -0.5px;
    }
    
    .subtitle {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1rem;
      max-width: 500px;
      line-height: 1.5;
      text-align: center;

    }
    
    .upload-area {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    
    .file-input {
      display: none;
    }
    
    .file-label {
      padding: 1rem 2rem;
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 500;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
    }
    
    .file-label:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }
    
    .file-label svg {
      width: 20px;
      height: 20px;
      fill: var(--primary);
    }
    
    .canvas-container {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 100%;
      max-height: 70vh;
      display: flex;
      justify-content: center;
    }
    
    canvas {
      display: block;
      max-width: 100%;
      max-height: 70vh;
      object-fit: contain;
      cursor: crosshair;
      transition: all 0.3s ease;
    }
    
    canvas:active {
      filter: brightness(1.05);
    }
    
    .instructions {
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
      text-align: center;
      margin-top: -0.5rem;
    }
    
    .controls {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .tool-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      align-items: center;
    }
    
    .btn {
      padding: 0.8rem 1.8rem;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn-primary {
      background: var(--primary);
      color: var(--darker);
      box-shadow: 0 4px 15px rgba(0, 255, 157, 0.3);
    }
    
    .btn-primary:hover {
      background: #00e68a;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 255, 157, 0.4);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .btn-secondary {
      background: var(--tertiary);
      color: var(--darker);
      box-shadow: 0 4px 15px rgba(255, 0, 170, 0.3);
    }
    
    .btn-secondary:hover {
      background: #e6009d;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 0, 170, 0.4);
    }
    
    .btn-secondary:active {
      transform: translateY(0);
    }
    
    .btn-primary svg, .btn-secondary svg {
      width: 18px;
      height: 18px;
    }
    
    .download-link {
      margin-top: 1rem;
      padding: 0.8rem 1.8rem;
      background: var(--secondary);
      color: var(--darker);
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      display: none;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 184, 255, 0.3);
    }
    
    .download-link:hover {
      background: #00a5e0;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 184, 255, 0.4);
    }
    
    .download-link svg {
      width: 18px;
      height: 18px;
    }
    
    .color-picker {
      display: none;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    
    .color-picker label {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .color-picker input {
      width: 40px;
      height: 30px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      background: var(--glass);
      cursor: pointer;
    }
    
    @media (max-width: 768px) {
      body {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .tool-buttons {
        flex-direction: column;
        width: 100%;
      }
      
      .btn, .download-link {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>CutMask- Image Section Remover</h1>
      <p class="subtitle">Remove unwanted sections or black-out areas in your image</p>
    </header>
    
    <div class="upload-area">
      <input type="file" id="upload" class="file-input" accept="image/*">
      <label for="upload" class="file-label">
        <svg viewBox="0 0 24 24">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        Upload Image
      </label>
      <p class="instructions" id="instructions">Select a tool and then draw on the image</p>
    </div>
    
    <div class="tool-buttons">
      <button id="cutBtn" class="btn btn-primary">
        <svg viewBox="0 0 24 24">
          <path d="M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1L9.64 7.64zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2zm6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5zM19 3l-6 6 2 2 7-7V3z"/>
        </svg>
        Remove & Join
      </button>
      <button id="blackoutBtn" class="btn btn-secondary">
        <svg viewBox="0 0 24 24">
          <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm0 16c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7z"/>
        </svg>
        Black-out Tool
      </button>
      <button id="applyBtn" class="btn btn-primary" style="display: none;">
        <svg viewBox="0 0 24 24">
          <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
        </svg>
        Apply
      </button>
    </div>
    
    <div class="color-picker" id="colorPicker">
      <label for="blackoutColor">Color:</label>
      <input type="color" id="blackoutColor" value="#000000">
    </div>
    
    <div class="canvas-container">
      <canvas id="canvas"></canvas>
    </div>
    
    <div class="controls">
      <a id="downloadLink" class="download-link" download="edited-image.png">
        <svg viewBox="0 0 24 24">
          <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
        </svg>
        Download Image
      </a>
    </div>
  </div>

<script>
    const upload = document.getElementById('upload');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const cutBtn = document.getElementById('cutBtn');
    const blackoutBtn = document.getElementById('blackoutBtn');
    const applyBtn = document.getElementById('applyBtn');
    const downloadLink = document.getElementById('downloadLink');
    const canvasContainer = document.querySelector('.canvas-container');
    const instructions = document.getElementById('instructions');
    const colorPicker = document.getElementById('colorPicker');
    const blackoutColor = document.getElementById('blackoutColor');

    let img = new Image();
    let cropStartX = 0;
    let cropStartY = 0;
    let cropEndX = 0;
    let cropEndY = 0;
    let isDragging = false;
    let hasSelection = false;
    let scaleFactor = 1;
    let currentTool = 'cut'; // 'cut' or 'blackout'

    // Tool selection
    cutBtn.addEventListener('click', () => {
      currentTool = 'cut';
      cutBtn.classList.add('btn-primary');
      cutBtn.classList.remove('btn-secondary');
      blackoutBtn.classList.add('btn-secondary');
      blackoutBtn.classList.remove('btn-primary');
      colorPicker.style.display = 'none';
      instructions.textContent = "Drag vertically on the image to select the area you want to remove";
    });

    blackoutBtn.addEventListener('click', () => {
      currentTool = 'blackout';
      blackoutBtn.classList.add('btn-primary');
      blackoutBtn.classList.remove('btn-secondary');
      cutBtn.classList.add('btn-secondary');
      cutBtn.classList.remove('btn-primary');
      colorPicker.style.display = 'flex';
      instructions.textContent = "Drag on the image to select the area you want to black-out";
    });

    // Initialize with cut tool selected
    cutBtn.click();

    upload.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = evt => {
        img.src = evt.target.result;
        downloadLink.style.display = 'none';
      };
      reader.readAsDataURL(file);
    });

    img.onload = () => {
      // Calculate scaling to fit within viewport
      const maxWidth = window.innerWidth - 40;
      const maxHeight = window.innerHeight * 0.7;
      
      scaleFactor = Math.min(
        maxWidth / img.width,
        maxHeight / img.height,
        1 // Don't scale up beyond original size
      );
      
      // Set canvas display dimensions (scaled down)
      canvas.style.width = `${img.width * scaleFactor}px`;
      canvas.style.height = `${img.height * scaleFactor}px`;
      
      // Set canvas internal dimensions (original size)
      canvas.width = img.width;
      canvas.height = img.height;
      
      // Draw the image at original size (will be scaled down by CSS)
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    };

    canvas.addEventListener('mousedown', e => {
      if (!img.src) return;
      
      const rect = canvas.getBoundingClientRect();
      cropStartX = (e.clientX - rect.left) / scaleFactor;
      cropStartY = (e.clientY - rect.top) / scaleFactor;
      isDragging = true;
      hasSelection = false;
      applyBtn.style.display = 'flex';
    });

    canvas.addEventListener('mousemove', e => {
      if (!isDragging || !img.src) return;
      
      const rect = canvas.getBoundingClientRect();
      cropEndX = (e.clientX - rect.left) / scaleFactor;
      
      if (currentTool === 'cut') {
        // For cut tool, only use vertical selection
        cropEndY = (e.clientY - rect.top) / scaleFactor;
        drawWithSelection();
      } else {
        // For blackout tool, use free selection
        cropEndY = (e.clientY - rect.top) / scaleFactor;
        drawWithSelection();
      }
    });

    canvas.addEventListener('mouseup', () => {
      if (!isDragging || !img.src) return;
      isDragging = false;
      hasSelection = true;
    });

    canvas.addEventListener('mouseleave', () => {
      isDragging = false;
    });

    function drawWithSelection() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

      if (!isDragging && !hasSelection) return;
      
      const x = Math.min(cropStartX, cropEndX);
      const y = currentTool === 'cut' ? Math.min(cropStartY, cropEndY) : Math.min(cropStartY, cropEndY);
      const w = currentTool === 'cut' ? canvas.width : Math.abs(cropEndX - cropStartX);
      const h = Math.abs(cropEndY - cropStartY);

      if (currentTool === 'cut') {
        // Modern selection overlay with gradient (for cut tool)
        const gradient = ctx.createLinearGradient(0, y, 0, y + h);
        gradient.addColorStop(0, 'rgba(255, 50, 50, 0.3)');
        gradient.addColorStop(0.5, 'rgba(255, 0, 0, 0.5)');
        gradient.addColorStop(1, 'rgba(255, 50, 50, 0.3)');
        
        ctx.fillStyle = gradient;
        ctx.fillRect(0, y, canvas.width, h);
        
        // Solid border for cut tool
        ctx.strokeStyle = '#ff0000';
        ctx.lineWidth = 2;
        ctx.strokeRect(0, y, canvas.width, h);
      } else {
        // Blackout tool selection
        ctx.fillStyle = 'rgba(255, 0, 170, 0.3)';
        ctx.fillRect(x, y, w, h);
        
        // Solid border using the selected blackout color
        ctx.strokeStyle = blackoutColor.value;
        ctx.lineWidth = 2;
        ctx.strokeRect(x, y, w, h);
      }
    }

    applyBtn.addEventListener('click', () => {
      if (!hasSelection) {
        showAlert("Please select an area first!");
        return;
      }

      if (currentTool === 'blackout') {
        applyBlackout();
      } else if (currentTool === 'cut') {
        applyCut();
      }
    });

    function applyBlackout() {
      const x = Math.min(cropStartX, cropEndX);
      const y = Math.min(cropStartY, cropEndY);
      const w = Math.abs(cropEndX - cropStartX);
      const h = Math.abs(cropEndY - cropStartY);

      if (w <= 0 || h <= 0) {
        showAlert("Invalid selection area.");
        return;
      }

      ctx.fillStyle = blackoutColor.value;
      ctx.fillRect(x, y, w, h);
      
      // Update image data
      img.src = canvas.toDataURL();
      hasSelection = false;
      applyBtn.style.display = 'none';

      // Enable download
      downloadLink.href = canvas.toDataURL();
      downloadLink.style.display = 'flex';
      
      showAlert("Area blacked out successfully!", "success");
    }

    function applyCut() {
      const topY = Math.min(cropStartY, cropEndY);
      const bottomY = Math.max(cropStartY, cropEndY);
      const cutHeight = bottomY - topY;

      if (cutHeight <= 0 || bottomY > img.height) {
        showAlert("Invalid selection area.");
        return;
      }

      const newHeight = img.height - cutHeight;
      const tempCanvas = document.createElement('canvas');
      const tempCtx = tempCanvas.getContext('2d');

      tempCanvas.width = img.width;
      tempCanvas.height = newHeight;

      // Top part
      tempCtx.drawImage(img, 0, 0, img.width, topY, 0, 0, img.width, topY);

      // Bottom part
      const remainingHeight = img.height - bottomY;
      tempCtx.drawImage(img, 0, bottomY, img.width, remainingHeight, 0, topY, img.width, remainingHeight);

      // Update main canvas
      canvas.width = img.width;
      canvas.height = newHeight;
      
      // Update display dimensions
      canvas.style.height = `${newHeight * scaleFactor}px`;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(tempCanvas, 0, 0);

      // Update image data
      img.src = tempCanvas.toDataURL();
      hasSelection = false;
      applyBtn.style.display = 'none';

      // Enable download
      downloadLink.href = canvas.toDataURL();
      downloadLink.style.display = 'flex';
      
      showAlert("Section removed successfully!", "success");
    }

    function showAlert(message, type = "error") {
      const alert = document.createElement('div');
      alert.textContent = message;
      alert.style.position = 'fixed';
      alert.style.bottom = '20px';
      alert.style.left = '50%';
      alert.style.transform = 'translateX(-50%)';
      alert.style.padding = '12px 24px';
      alert.style.borderRadius = '8px';
      alert.style.fontWeight = '600';
      alert.style.zIndex = '1000';
      alert.style.animation = 'fadeIn 0.3s ease-out';
      alert.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.3)';
      
      if (type === "error") {
        alert.style.background = 'rgba(255, 50, 50, 0.9)';
        alert.style.color = 'white';
      } else {
        alert.style.background = 'rgba(0, 255, 157, 0.9)';
        alert.style.color = 'var(--darker)';
      }
      
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.style.animation = 'fadeOut 0.3s ease-out';
        setTimeout(() => {
          document.body.removeChild(alert);
        }, 300);
      }, 3000);
    }

    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
        from { opacity: 0; transform: translateX(-50%) translateY(20px); }
        to { opacity: 1; transform: translateX(-50%) translateY(0); }
      }
      @keyframes fadeOut {
        from { opacity: 1; transform: translateX(-50%) translateY(0); }
        to { opacity: 0; transform: translateX(-50%) translateY(20px); }
      }
    `;
    document.head.appendChild(style);

    // Handle window resize
    window.addEventListener('resize', () => {
      if (img.width) {
        const maxWidth = window.innerWidth - 40;
        const maxHeight = window.innerHeight * 0.7;
        
        scaleFactor = Math.min(
          maxWidth / img.width,
          maxHeight / img.height,
          1
        );
        
        canvas.style.width = `${img.width * scaleFactor}px`;
        canvas.style.height = `${img.height * scaleFactor}px`;
      }
    });
</script>
</body>
</html>
